<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <meta property="og:title" content="Deploy a fully automated web-app using AWS, Terraform and Ansible" />
<meta property="og:description" content="We would be using Infrastructure as Code (IaC) principle to fully automate the provisioning and deployment of all the components to successfully run a python application. Terraform is one of the best tool available to provision infratructure on your preferred cloud, but once the infrastructure is put it place, In order to deploy highly scalable applications we would need a configuration management tool like Ansible to help deploy various software components to these virtual machines." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anees009.github.io/post/aws-terraform-ansible-webapp/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-05T22:02:26&#43;00:00" />
<meta property="article:modified_time" content="2021-06-05T22:02:26&#43;00:00" /><meta property="og:site_name" content="Cloud &amp; Containers" />


        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deploy a fully automated web-app using AWS, Terraform and Ansible"/>
<meta name="twitter:description" content="We would be using Infrastructure as Code (IaC) principle to fully automate the provisioning and deployment of all the components to successfully run a python application. Terraform is one of the best tool available to provision infratructure on your preferred cloud, but once the infrastructure is put it place, In order to deploy highly scalable applications we would need a configuration management tool like Ansible to help deploy various software components to these virtual machines."/>
<meta name="twitter:site" content="@sssssbutton"/>

        
        <title>
  Deploy a fully automated web-app using AWS, Terraform and Ansible | Anees Patel
</title>

        <link rel="icon" type="image/png" href='https://anees009.github.io/images/favicon-16x16.png' sizes="16x16">
        <link rel="icon" type="image/png" href='https://anees009.github.io/images/favicon-32x32.png' sizes="32x32">  

        <link href="https://fonts.googleapis.com/css?family=Oswald:400" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">      
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
        
        
        
        

        <link rel="stylesheet" href="https://anees009.github.io/css/bundle.min.7ca6cd3bb53a831d18b6183000ae658b8d6f672f7acab1b00f788e5fe8b5d844.css" integrity="sha256-fKbNO7U6gx0YthgwAK5li41vZy96yrGwD3iOX&#43;i12EQ="  />

        
    <link rel="me" type="text/html" href="https://twitter.com/sssssbutton"/> 
<link rel="me" type="text/html" href="https://www.linkedin.com/in/anees-patel-00964182/"/> 
<link rel="icon" type="image/png" href="https://anees009.github.io/images/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://anees009.github.io/images/favicon-32x32.png" sizes="32x32">

<link rel="alternate" type="application/rss+xml" href='https://anees009.github.io/index.xml' />

<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="author" content="Anees Patel" />
<meta name="copyright" content="All rights reserved." />


<meta name="description" content="We would be using Infrastructure as Code (IaC) principle to fully automate the provisioning and deployment of all the components to successfully run a python application. Terraform is one of the best tool available to provision infratructure on your preferred cloud, but once the infrastructure is put it place, In order to deploy highly scalable applications we would need a configuration management tool like Ansible to help deploy various software components to these virtual machines.">


    
        
    </head>
    <body>
        <nav class="navbar fixed-top navbar-expand-md navbar-dark bg-dark py-1 top-nav">
            <div class="container">
                    <a class="navbar-brand pr-2" href="https://anees009.github.io/">ANEES PATEL</a>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="navbar-collapse collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
    <a class="nav-link active" href="https://anees009.github.io/categories/development/">Development</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="https://anees009.github.io/categories/golang/">Golang</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="https://anees009.github.io/about/">About</a>
</li>
                    </ul>
                    <div class="social-icons d-none d-lg-block">
                        <a class="py-2 px-2" href="https://twitter.com/sssssbutton"><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2" href="https://www.linkedin.com/in/anees-patel-00964182/"><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2" href="https://github.com/anees009"><i class="fab fa-github"></i></a>
<a class="py-2 px-2" href='https://anees009.github.io/index.xml'><i class="fas fa-rss"></i></a>

                    </div>
                </div>
            </div>
        </nav>

        
<header class="feature-image d-print-none">
</header>

        
        <div class="main">
            
<div class="container mt-4 post">
    <h1>Deploy a fully automated web-app using AWS, Terraform and Ansible</h1>
    <div class="mb-3">
    <small>
        <strong>By Anees Patel</strong>
        | <i class="far fa-calendar-alt"></i>&nbsp;Jun 5, 2021&nbsp;
        | <i class="fa fa-tags" title="Tags" aria-hidden="true"></i> <a href='https://anees009.github.io/tags/terraform/'>terraform</a>, <a href='https://anees009.github.io/tags/ansible/'>ansible</a>, <a href='https://anees009.github.io/tags/aws/'>aws</a>
    </small>
</div>

    <div class="share-icons d-flex justify-content-center d-print-none">
        <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&text=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&t=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&title=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
    </div>

    <div class="mt-4 mb-4 main-content">
        <p>We would be using Infrastructure as Code (IaC) principle to fully automate the provisioning and deployment of all the components to successfully run a python application.
<a href="https://www.terraform.io/">Terraform</a> is one of the best tool available to provision infratructure on your preferred cloud, but once the infrastructure is put it place, In order to deploy highly scalable applications we would need a configuration management tool like <a href="https://www.ansible.com/">Ansible</a> to help deploy various software components to these virtual machines.</p>
<h2 id="prerequisites">Prerequisites:</h2>
<ul>
<li><a href="https://www.terraform.io/">Terraform</a> - Install Terraform</li>
<li><a href="https://www.ansible.com/">Ansible</a> - Install Ansible</li>
<li>python3</li>
<li>AWS free tier account with credentials for IAM user having Admin Access</li>
</ul>
<h2 id="sample-architecture">Sample Architecture</h2>
<ol>
<li>
<p>Provision 3 separate ec2 instances on AWS</p>
<pre><code>2 x application instances
1 x web-server
</code></pre>
</li>
<li>
<p>Deploy the python application to the application instances with the app serving on port 8000.</p>
</li>
<li>
<p>Deploy NGINX on the web-server which will act as reverse proxy and loadbalancing requests.</p>
</li>
</ol>
<p>As part of this deployment the following AWS resources will be deployed, All the AWS resouces only consume the free-tire account.</p>
<ol>
<li>1 instance of ec2 that will be a nginx web-server and a reverse proxy</li>
<li>2 instances of ec2 for app-server</li>
<li>1 key-part for ssh connections</li>
<li>1 VPC to isolate the network environment from existing resources</li>
<li>2 security groups, 1 each for web-server and app-server</li>
</ol>
<h2 id="deployment">Deployment:</h2>
<p>The source code can be found at this <a href="https://github.com/anees009/aws-terraform-ansible-webapp">github-repo</a> for your reference.</p>
<p>The sample <a href="https://github.com/anees009/aws-terraform-ansible-webapp/blob/main/ansible/roles/app_server/files/server.py">python-app</a> is a simple HTTP server which will keep listining at port 8000, It will serve the requests and respond with the IP of the host.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">http.server</span>
<span class="kn">import</span> <span class="nn">socketserver</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">from</span> <span class="nn">http</span> <span class="kn">import</span> <span class="n">HTTPStatus</span>

<span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">HTTPStatus</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;Hi there, I&#39;m served from </span><span class="si">%s</span><span class="s2">!</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
        <span class="c1"># convert string to byte  </span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="n">httpd</span> <span class="o">=</span> <span class="n">socketserver</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
<span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>

</code></pre></div><h3 id="terraform-files">Terraform files:</h3>
<h4 id="define-aws-as-the-cloud-provider">Define AWS as the cloud provider</h4>


        <div class="share-icons d-flex justify-content-center d-print-none">
            <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&text=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&t=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fanees009.github.io%2fpost%2faws-terraform-ansible-webapp%2f&title=Deploy%20a%20fully%20automated%20web-app%20using%20AWS%2c%20Terraform%20and%20Ansible&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
        </div>
    </div>

    
</div>
<div class="sidebar d-print-none d-none d-xl-block">
    
        <h2>Anees Patel</h2>
        <div>
            All things Linux
        </div>
        <a href='https://anees009.github.io/about/' class="btn btn-outline-secondary mt-3" role="button">Read More...</a>
        <h2 class="mt-4">Top Posts</h2>
    
    
    <h2 class="mt-4">Recent Posts</h2>
    <nav class="nav flex-column">
        
        <a href="https://anees009.github.io/post/aws-terraform-ansible-webapp/" class="nav-link">Deploy a fully automated web-app using AWS, Terraform and Ansible</a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">categories</h2>
    <nav class="nav flex-column">
        
        <a href='https://anees009.github.io/categories/software-development/' class="nav-link">
        software-development
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">tags</h2>
    <nav class="nav flex-column">
        
        <a href='https://anees009.github.io/tags/ansible/' class="nav-link">
        ansible
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='https://anees009.github.io/tags/aws/' class="nav-link">
        aws
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='https://anees009.github.io/tags/terraform/' class="nav-link">
        terraform
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
    </nav>
    
</div>

        </div>

        <footer class="mt-auto footer d-print-none">
            <div class="container-fluid">
                <div class="row justify-content-center">
                    <div class="col-md-4 col-xl-3">
                        <h5>All rights reserved.</h5>
I&#39;m happy for you to share content on this site, 
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>Disclaimer</h5>
Opinions expressed here are my own and may not reflect those of the company I work for, or the people I work with.
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>About This Site</h5>
This blog is maintained by <a href="https://www.linkedin.com/in/anees-patel-00964182/"> Anees Patel</a>
                    </div>
                </div>

                <hr />

                <div class="d-flex justify-content-center icons">
                    <a class="py-2 px-2" href="https://twitter.com/sssssbutton"><i class="fab fa-twitter"></i></a>
<a class="py-2 px-2" href="https://www.linkedin.com/in/anees-patel-00964182/"><i class="fab fa-linkedin"></i></a>
<a class="py-2 px-2" href="https://github.com/anees009"><i class="fab fa-github"></i></a>
<a class="py-2 px-2" href='https://anees009.github.io/index.xml'><i class="fas fa-rss"></i></a>

                </div>
            </div>
        </footer>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

        
    </body>
</html>
